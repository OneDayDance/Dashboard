/* --- Fluid Gradient Background --- */
:root {
    --ang: 0deg; /* Start at 0 for a seamless loop */
    --c1: #FF9D76;
    --c2: #76F1FF;
    --c3: #C176FF;
    --c4: #FFE176;
}

html::before {
    content: "";
    position: fixed;
    left: 0; top: 0; right: 0; bottom: 0;
    z-index: -1;
    background: linear-gradient(var(--ang), var(--c1), var(--c2), var(--c3), var(--c4));
    background-size: 200% 200%;
    animation: bg-pan 18s ease-in-out infinite alternate, bg-rotate 36s linear infinite;
    pointer-events: none;
}

@keyframes bg-pan {
    0%   { background-position: 0% 0%; }
    50%  { background-position: 100% 0%; }
    100% { background-position: 0% 100%; }
}

@keyframes bg-rotate {
    from { --ang: 0deg; } /* Explicitly start at 0 */
    to { --ang: 360deg; } /* End at 360 (visually same as 0) */
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    color: #333;
    padding: 20px;
}

/* --- Landing Page --- */
#landing-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 2000;
}

.landing-box {
    background-color: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    text-align: center;
}

.landing-box h1 { margin-top: 0; }
.landing-box p { margin-bottom: 20px; }

/* --- General Layout & Themed UI --- */
header, .card, main {
    background-color: rgba(255, 255, 255, 0.85); /* Semi-transparent white */
    backdrop-filter: blur(10px); /* Frosted glass effect */
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

header {
    text-align: center;
    margin-bottom: 20px;
    position: relative;
}

main { padding: 20px; }

#auth-container {
    position: absolute;
    top: 20px;
    right: 20px;
}

/* --- Themed Buttons --- */
button {
    border: none;
    padding: 8px 16px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    font-weight: bold;
    color: white;
    transition: transform 0.2s ease, box-shadow 0.2s ease, background-color 0.2s ease;
}

button:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

button[disabled] {
    background-color: #ccc !important;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

#authorize_button, .view-controls button.active, #modal-save-note-btn, #save-columns-btn, #client-modal-save-btn, #save-client-columns-btn, #signout_button, #client-modal-edit-btn, #project-actions-btn, #gdrive-link-save-btn {
    background-color: #FF9D76; /* Orange */
}
#request-view-toggle-btn {
     background-color: #fff;
     color: #333;
}
/* Specific button overrides */
#client-tab-actions button, #add-client-form button, #create-project-form button, #task-details-form button, #add-subtask-btn, #add-link-btn, #project-edit-btn, #project-save-btn, #add-bucket-btn, .add-task-to-bucket-btn, #modal-create-client-btn, #modal-create-project-btn {
    background-color: #FF9D76;
}
.add-task-to-bucket-btn {
    width: 100%;
    margin-top: 5px;
    background-color: rgba(255, 157, 118, 0.2);
    color: #555;
}
.add-task-to-bucket-btn:hover {
     background-color: #FF9D76;
     color: white;
}
#delete-client-btn, #delete-project-btn { background-color: #dc3545 !important; }
#delete-confirm-btn, #delete-project-confirm-btn { background-color: #dc3545; }


/* --- Themed Tabs --- */
.tabs-container {
    background-color: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 10px 20px 0;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    margin-bottom: 20px;
}
.tab-nav {
    display: flex;
    border-bottom: 2px solid #ccc;
}
.tab-button {
    padding: 10px 20px;
    cursor: pointer;
    background-color: transparent;
    font-size: 16px;
    border-bottom: 3px solid transparent;
    margin-bottom: -2px;
    color: #333;
}
.tab-button:hover { background-color: rgba(0, 0, 0, 0.05); }
.tab-button.active {
    border-bottom-color: #76F1FF;
    font-weight: bold;
}

/* --- Controls & Table Styles --- */
.main-header-controls { margin-bottom: 20px; }
.controls-container { display: flex; justify-content: space-between; align-items: center; gap: 20px; }
.filter-controls { display: flex; gap: 10px; flex-grow: 1; }
#search-bar, #client-search-bar { min-width: 150px; flex-grow: 1; }
.filter-controls input, .filter-controls select { padding: 8px; border-radius: 4px; border: 1px solid #ccc; width: 100%; }
.view-controls { display: flex; gap: 10px; flex-shrink: 0; }
.view-controls button { background-color: #fff; color: #333; }
.data-table { width: 100%; border-collapse: collapse; }
.data-table th, .data-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
.data-table th { background-color: rgba(255, 255, 255, 0.6); }
.data-table th.sortable { cursor: pointer; position: relative; }
.data-table th.sortable:hover { background-color: #e2e2e2; }
.data-table th.sortable::after { content: '\2195'; opacity: 0.3; position: absolute; right: 8px; }
.data-table th.sorted-asc::after { content: '\25B2'; opacity: 1; }
.data-table th.sorted-desc::after { content: '\25BC'; opacity: 1; }
.data-table tbody tr:hover { background-color: #e9ecef; cursor: pointer; }

/* --- Clients Tab Layout --- */
.client-layout-container { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; align-items: start; }
.client-list-container .controls-container { padding: 0; }
#add-client-form { display: flex; flex-direction: column; gap: 10px; }
#add-client-form input { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }

/* --- Projects Tab Layout & Sidebar Animation --- */
.project-layout-container {
    display: grid;
    grid-template-columns: 300px 1fr;
    gap: 20px;
    align-items: start;
    transition: grid-template-columns 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.project-layout-container.collapsed {
    grid-template-columns: 40px 1fr; /* Adjust for icon positioning */
}

/* Sidebar Column */
.project-list-column {
    position: sticky;
    top: 20px;
    align-self: start;
    height: calc(100vh - 180px);
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Crucial for clipping content */
    transition: padding 0.4s cubic-bezier(0.4, 0, 0.2, 1),
                background-color 0.3s ease 0.1s,
                border-color 0.3s ease 0.1s,
                box-shadow 0.3s ease 0.1s,
                backdrop-filter 0.3s ease 0.1s;
}

.project-layout-container.collapsed .project-list-column {
    padding: 5px 0; /* Adjust padding for icon positioning */
    background-color: transparent;
    border-color: transparent;
    box-shadow: none;
    backdrop-filter: none;
}

/* Sidebar Header */
.project-list-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    flex-shrink: 0;
    gap: 10px; /* Add gap between title and button */
}

.project-layout-container.collapsed .project-list-header {
    margin-bottom: 0;
}

/* Sidebar Title */
#project-list-title {
    margin: 0;
    white-space: nowrap;
    overflow: hidden;
    flex-grow: 1; /* Allow it to shrink */
    min-width: 0; /* Important for flex shrinking */
    transition: opacity 0.2s ease, max-width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    max-width: 500px; /* Animate from a large value */
}

.project-layout-container.collapsed #project-list-title {
    opacity: 0;
    max-width: 0;
    pointer-events: none;
}

/* Generic Sidebar Content (Search, Lists) */
.project-search-container,
.project-list,
.project-list-column .collapsible-header,
.project-list-column > h3 {
    transition: opacity 0.2s ease;
    opacity: 1;
}

.project-layout-container.collapsed .project-search-container,
.project-layout-container.collapsed .project-list,
.project-layout-container.collapsed .project-list-column .collapsible-header,
.project-layout-container.collapsed .project-list-column > h3 {
    opacity: 0;
    pointer-events: none;
}

.project-search-container { padding-bottom: 15px; flex-shrink: 0; }
#project-search-bar { width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; box-sizing: border-box; }
.project-list {
    list-style: none;
    padding: 0;
    margin: 0;
    overflow-y: auto;
    flex-grow: 1;
}
.project-list-item { padding: 10px; border-bottom: 1px solid #eee; cursor: pointer; transition: background-color 0.2s ease, padding 0.2s ease; position: relative; }
.project-list-item:hover { background-color: #e9ecef; }
.project-list-item.active { background-color: #d4f4ff; font-weight: bold; }
.project-list-item h4 { margin: 0 0 5px 0; }
.project-list-item p { margin: 0; font-size: 12px; color: #555; }

/* Collapse Button */
#project-list-collapse-btn {
    font-size: 20px;
    padding: 0;
    background: #eee;
    color: #333;
    border-radius: 8px;
    width: 40px;
    height: 40px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s ease;
}

#project-list-collapse-btn:hover {
    background-color: #ddd;
}

.project-layout-container.collapsed #project-list-collapse-btn {
    background-color: #fff;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.project-layout-container.collapsed #project-list-collapse-btn:hover {
    background-color: #f5f5f5;
}

/* Target the SVG icon inside the button for rotation */
#project-list-collapse-btn svg {
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.project-layout-container.collapsed #project-list-collapse-btn svg {
    transform: rotate(180deg);
}

/* Project Details View */
#project-details-column h3 { margin-top: 0; }
.project-details-header { display: flex; justify-content: space-between; align-items: center; }
.project-actions-dropdown { position: relative; }
.project-actions-dropdown-content { display: none; position: absolute; right: 0; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; border-radius: 5px; }
.project-actions-dropdown-content a { color: black; padding: 12px 16px; text-decoration: none; display: block; }
.project-actions-dropdown-content a:hover { background-color: #f1f1f1; }
.project-actions-dropdown-content a.delete { color: #dc3545; }

/* 2x2 Grid Layout */
.project-details-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-auto-rows: min-content;
    gap: 20px;
    margin-bottom: 20px;
}
.project-details-section {
    background: #f9f9f9;
    border: 1px solid #eee;
    padding: 15px;
    border-radius: 8px;
}
.project-details-grid .project-details-section,
.project-details-grid .interactive-card {
    margin: 0;
}
.project-details-grid ul { list-style: none; padding: 0; margin: 0; }
.project-details-grid li { font-size: 14px; }
.project-details-grid li:not(:last-child) { margin-bottom: 8px; }
.project-details-grid li strong {
    font-weight: bold;
    color: #555;
    width: auto;
    display: inline-block;
    margin-right: 5px;
}
.project-details-section-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ccc; padding-bottom: 5px; margin-bottom: 10px; }
.project-details-section-header h4 { border: none; margin: 0; padding: 0;}


/* Interactive Info Cards */
.interactive-card {
    background: #f9f9f9;
    border: 1px solid #eee;
    padding: 15px;
    border-radius: 8px;
    position: relative;
    overflow: hidden;
    transition: all 0.3s ease;
    cursor: pointer;
    text-align: center;
    display: flex;
    flex-direction: column;
    justify-content: center;
}
.interactive-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    border-color: #FF9D76;
}
.interactive-card .card-main-content,
.interactive-card .card-hover-content {
    transition: opacity 0.3s ease, transform 0.3s ease;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}
.interactive-card .card-main-content h4 { margin: 0; font-size: 14px; color: #555; }
.interactive-card .card-main-content p { margin: 5px 0 0; font-size: 16px; font-weight: bold; }
.interactive-card .card-hover-content {
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    padding: 15px;
    opacity: 0;
    transform: translateY(10px);
}
.interactive-card:hover .card-main-content {
    opacity: 0;
    transform: translateY(-10px);
}
.interactive-card:hover .card-hover-content {
    opacity: 1;
    transform: translateY(0);
}
.interactive-card .card-hover-content p {
    margin: 2px 0;
    font-size: 16px;
    color: #333;
    font-weight: bold;
}
.interactive-card .card-hover-content span {
    font-weight: normal;
    color: #666;
    font-size: 12px;
}
.folder-link-container { justify-content: center; }
.folder-link-container .card-main-content { gap: 8px; }
.folder-link-container svg { width: 32px; height: 32px; fill: #5f6368; }
.folder-link-container .card-main-content h4 { font-size: 16px; margin-top: 5px; }

/* Tasks Section */
.task-bucket { cursor: grab; transition: all 0.2s ease-in-out; border: 2px solid transparent; }
.task-bucket:hover { border-color: #76F1FF; }
.task-bucket h5 { background-color: #f0f0f0; padding: 5px 10px; border-radius: 4px; margin: 15px 0 5px; }
.task-list { list-style-type: none; padding: 0; }
.task-item { display: flex; flex-direction: column; align-items: flex-start; gap: 5px; padding: 8px; border-bottom: 1px solid #eee; cursor: pointer; background-color: white; border-radius: 4px; margin-bottom: 5px; transition: all 0.2s ease-in-out; }
.task-item:hover { transform: scale(1.02); box-shadow: 0 3px 6px rgba(0,0,0,0.1); }
.task-main { display: flex; align-items: center; gap: 10px; width: 100%;}
.task-main input[type="checkbox"] { width: 20px; height: 20px; flex-shrink: 0;}
.task-main label { flex-grow: 1; }
.task-main.completed label { text-decoration: line-through; color: #888; }
.subtask-list { list-style: none; padding-left: 30px; margin-top: 5px; width: 100%;}
.subtask-item { display: flex; align-items: center; gap: 8px; font-size: 12px; padding: 2px 0;}
.subtask-item input { cursor: pointer; }
.task-progress { width: 100%; background-color: #eee; border-radius: 4px; height: 6px; margin-top: 4px;}
.task-progress-bar { background-color: #76F1FF; height: 100%; border-radius: 4px; }
.task-board { display: flex; flex-wrap: wrap; gap: 15px; padding: 10px 0; min-height: 200px; }
.task-board-column { flex: 0 0 300px; background: #f4f5f7; border-radius: 8px; padding: 10px; cursor: grab; transition: all 0.2s ease-in-out; border: 2px solid transparent; }
.task-board-column:hover { border-color: #76F1FF; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.task-board-column h5 { text-align: center; margin: 5px 0 15px; }
.task-card { background: #fff; border-radius: 4px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); padding: 10px; margin-bottom: 10px; cursor: pointer; transition: all 0.2s ease-in-out; }
.task-card:hover { transform: scale(1.03); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
.subtask-summary { font-size: 12px; color: #555; margin: 5px 0 0; }

/* --- Drag and Drop Enhancements --- */
.dragging {
    opacity: 0.4 !important;
    background: #cceeff !important;
    transform: scale(1.0) !important;
    box-shadow: none !important;
}

.task-placeholder, .bucket-placeholder {
    background-color: rgba(118, 241, 255, 0.3);
    border: 2px dashed #76F1FF;
    border-radius: 4px;
    margin-bottom: 5px; /* Match task-item */
    box-sizing: border-box;
    transition: all 0.1s ease;
    pointer-events: none;
}

.bucket-placeholder {
    border-radius: 8px;
    flex: 0 0 300px; /* Match .task-board-column */
}


/* --- Themed Modals --- */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5); backdrop-filter: blur(5px); }
.modal-content {
    background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 800px; border-radius: 12px; position: relative; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    max-height: 90vh;
}
#details-modal #modal-body {
    flex-grow: 1;
    overflow-y: auto;
    padding-bottom: 10px;
}
#details-modal .modal-actions {
    flex-shrink: 0;
}
.modal-footer { text-align: right; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; flex-shrink: 0; }
.close-button { color: #aaa; position: absolute; top: 10px; right: 20px; font-size: 28px; font-weight: bold; }
.close-button:hover, .close-button:focus { color: black; text-decoration: none; cursor: pointer; }

/* Client Modal Tabs */
.client-modal-tabs { display: flex; border-bottom: 1px solid #ccc; margin-bottom: 15px; }
.client-tab-button { padding: 10px 15px; cursor: pointer; background: none; border: none; font-size: 16px; border-bottom: 3px solid transparent; margin-bottom: -1px; color: #333; }
.client-tab-button.active { border-bottom-color: #76F1FF; font-weight: bold; }
.client-tab-content { display: none; padding: 10px 0; max-height: 40vh; overflow-y: auto; }
.client-tab-content.active { display: block; }

/* Modal Content Styling */
#modal-body ul, .client-tab-content ul { list-style-type: none; padding: 0; }
#modal-body li, .client-tab-content li { padding: 8px 0; border-bottom: 1px solid #eee; display: flex; align-items: center; }
.client-tab-content a { color: #FF9D76; text-decoration: none; font-weight: bold; cursor: pointer; }
#modal-body li strong, .client-tab-content li strong { display: inline-block; width: 180px; color: #555; flex-shrink: 0;}
.client-tab-content input, .client-tab-content textarea, .client-tab-content select, #delete-confirm-input, .form-field input, .form-field textarea, .form-field select, #gdrive-link-input {
    width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ccc; box-sizing: border-box;
}
#delete-confirm-input { margin-top: 10px; }
.warning-box { background-color: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; padding: 10px; border-radius: 5px; margin-bottom: 15px; }
.client-tab-content textarea { min-height: 80px; resize: vertical; }
#client-tab-notes h3, #client-tab-history h3, #client-tab-financials h3, #client-tab-actions h3 { margin-top: 15px; margin-bottom: 10px; }
#client-tab-notes h3:first-child, #client-tab-history h3:first-child, #client-tab-actions h3:first-child { margin-top: 0; }
#client-tab-actions { display: flex; gap: 10px; align-items: flex-start; flex-wrap: wrap; }
.contact-log { border: 1px solid #eee; padding: 10px; border-radius: 5px; margin-bottom: 10px; background: #f9f9f9; }
.contact-log small { font-weight: bold; color: #555; }
.modal-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; border-top: 1px solid #eee; padding-top: 15px; }
#modal-request-actions-section { display: flex; flex-direction: column; gap: 10px; align-items: flex-start;}
#modal-notes-textarea { width: 95%; min-height: 80px; margin-top: 10px; padding: 5px; }
#column-checkboxes, #client-column-checkboxes { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin: 20px 0; }
#column-checkboxes label, #client-column-checkboxes label { display: flex; align-items: center; gap: 8px; }
.collapsible-header { display: flex; justify-content: space-between; align-items: center; cursor: pointer; padding: 10px 0; border-top: 1px solid #ccc; margin-top: 20px; }
.collapsible-header h2, .collapsible-header h3 { margin: 0; }
.toggle-arrow { font-size: 18px; transition: transform 0.3s ease; }
.collapsible-content { max-height: 2000px; overflow: hidden; transition: max-height 0.5s ease-in-out; }
.collapsible-content.collapsed { max-height: 0; padding-top: 0; padding-bottom: 0; margin-top: 0; border-top: none; }
.collapsible-header.collapsed .toggle-arrow { transform: rotate(-90deg); }
.card-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
.request-card, .client-card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; background-color: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); cursor: pointer; transition: all 0.2s ease-in-out; }
.request-card:hover, .client-card:hover { border-color: #FF9D76; box-shadow: 0 4px 8px rgba(0,0,0,0.1); transform: translateY(-3px); }
.request-card h3, .client-card h3 { margin-top: 0; }
.request-card p, .client-card p { margin: 5px 0; color: #555; font-size: 14px; }
.add-item-form { display: flex; gap: 5px; margin-top: 5px; }
.add-item-form input { flex-grow: 1; }
.item-tag a { color: #FF9D76; }
.item-tag { background: #eee; border-radius: 4px; padding: 2px 6px; display: inline-flex; align-items: center; gap: 4px; margin: 2px; }
.item-tag button { background: none; border: none; color: #888; cursor: pointer; font-size: 14px; padding: 0;}

/* Task Modal Subtask Styling */
#task-details-form {
    overflow-y: auto;
    padding-right: 15px; /* Space for scrollbar */
    margin-right: -15px;
}
#subtasks-container-modal {
    cursor: grab;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    max-height: 150px;
    overflow-y: auto;
    background-color: #fdfdfd;
}
#subtasks-container-modal .subtask-item {
    display: flex;
    flex-wrap: nowrap;
    gap: 8px;
    align-items: center;
    padding: 5px;
    background-color: #f9f9f9;
    border-radius: 3px;
    margin-top: 3px;
}
#subtasks-container-modal .subtask-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
}
#subtasks-container-modal .subtask-item label {
    flex-grow: 1;
    min-width: 0;
    word-break: break-word;
}
#subtasks-container-modal .subtask-item button {
    flex-shrink: 0;
}


/* Form Field & Grid styles for modals */
.form-field { margin-bottom: 15px; }
.form-field label { display: block; margin-bottom: 5px; font-weight: bold; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

