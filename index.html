<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ODD Dashboard</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="landing-container">
        <div class="landing-box">
            <h1>Client Management Dashboard</h1>
            <p>Please authorize to manage your clients.</p>
            <button id="authorize_button" disabled>Loading...</button>
        </div>
    </div>

    <div id="app-container" style="display: none;">
        <header>
            <h1>Client Management Dashboard</h1>
            <div id="auth-container">
                <button id="signout_button">Sign Out</button>
            </div>
        </header>

        <div class="tabs-container">
            <nav class="tab-nav">
                <button class="tab-button active" data-tab="requests">Requests</button>
                <button class="tab-button" data-tab="analytics">Analytics</button>
                <button class="tab-button" data-tab="clients">Clients</button>
                <button class="tab-button" data-tab="projects">Projects</button>
                <button class="tab-button" data-tab="costumes">Costumes</button>
                <button class="tab-button" data-tab="equipment">Equipment</button>
            </nav>
        </div>

        <main id="tab-requests" class="tab-content">
            <div class="main-header-controls">
                <h2>New Service Requests</h2>
                <div class="controls-container">
                    <div class="filter-controls">
                        <input type="text" id="search-bar" placeholder="Search requests...">
                        <select id="service-filter">
                            <option value="all">All Services</option>
                        </select>
                        <select id="status-filter">
                            <option value="all">All Statuses</option>
                            <option value="new">New</option>
                            <option value="archived">Archived</option>
                        </select>
                    </div>
                    <div class="view-controls">
                        <button id="list-view-btn" class="active">List View</button>
                        <button id="card-view-btn">Card View</button>
                        <button id="column-select-btn">Display Options</button>
                    </div>
                </div>
            </div>
            <div id="requests-container"></div>
            
            <div class="collapsible-header" id="archive-toggle">
                <h2>Archived Requests</h2>
                <span class="toggle-arrow">&#9662;</span>
            </div>
            <div id="archived-requests-container" class="collapsible-content"></div>
        </main>

        <main id="tab-analytics" class="tab-content" style="display: none;"><h2>Analytics</h2><p>Charts and key metrics will go here.</p></main>
        
        <main id="tab-clients" class="tab-content" style="display: none;">
            <div class="client-layout-container">
                <div class="client-list-container card">
                    <div class="main-header-controls">
                        <h2>Current Clients</h2>
                        <div class="controls-container">
                            <div class="filter-controls">
                                <input type="text" id="client-search-bar" placeholder="Search clients...">
                                <select id="client-status-filter">
                                    <option value="all">All Statuses</option>
                                    <option value="Active">Active</option>
                                    <option value="Inactive">Inactive</option>
                                </select>
                            </div>
                             <div class="view-controls">
                                <button id="client-list-view-btn" class="active">List View</button>
                                <button id="client-card-view-btn">Card View</button>
                                <button id="client-column-select-btn">Display Options</button>
                            </div>
                        </div>
                    </div>
                    <div id="client-table-container"></div>
                </div>
                <div class="add-client-container card">
                    <h2>Add New Client</h2>
                    <form id="add-client-form">
                        <input type="text" id="client-first-name" placeholder="First Name" required>
                        <input type="text" id="client-last-name" placeholder="Last Name" required>
                        <input type="email" id="client-email" placeholder="Email" required>
                        <button type="submit">Add Client</button>
                    </form>
                    <div id="add-client-status"></div>
                </div>
            </div>
        </main>

        <main id="tab-projects" class="tab-content" style="display: none;">
            <div id="project-layout-container" class="project-layout-container">
                <div class="project-list-column card">
                    <div class="project-list-header">
                        <button id="project-list-collapse-btn" title="Toggle Project List">â€¹</button>
                        <h2 id="project-list-title">Projects</h2>
                    </div>
                    <h3>Active Projects</h3>
                    <div id="active-projects-list" class="project-list"></div>
                    <div class="collapsible-header" id="archived-projects-toggle">
                        <h3>Archived Projects</h3>
                         <span class="toggle-arrow">&#9662;</span>
                    </div>
                    <div id="archived-projects-list" class="collapsible-content project-list"></div>
                </div>
                <div id="project-details-column" class="card">
                    <p>Select a project to view its details.</p>
                </div>
            </div>
        </main>
        <main id="tab-costumes" class="tab-content" style="display: none;"><h2>Costumes</h2><p>Costume inventory management will go here.</p></main>
        <main id="tab-equipment" class="tab-content" style="display: none;"><h2>Equipment</h2><p>Equipment tracking will go here.</p></main>
    </div>

    <!-- MODALS -->
    <!-- Request Details Modal -->
    <div id="details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modal-title">Request Details</h2>
            <div id="modal-body"></div>
            <div class="modal-actions">
                <div id="modal-notes-section">
                    <h3>Notes</h3>
                    <textarea id="modal-notes-textarea"></textarea>
                    <button id="modal-save-note-btn">Save Note</button>
                    <span id="modal-note-status"></span>
                </div>
                <div id="modal-request-actions-section">
                    <h3>Actions</h3>
                    <button id="modal-create-client-btn">Create Client</button>
                    <button id="modal-create-project-btn">Create Project</button>
                    <span id="modal-request-actions-status"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Client Details Modal -->
    <div id="client-details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Client Details</h2>
            <div class="client-modal-tabs">
                <button class="client-tab-button active" data-tab="details" data-editable="true">Details</button>
                <button class="client-tab-button" data-tab="history" data-editable="false">History</button>
                <button class="client-tab-button" data-tab="notes" data-editable="true">Notes & Logs</button>
                <button class="client-tab-button" data-tab="financials" data-editable="false">Financials</button>
                <button class="client-tab-button" data-tab="actions" data-editable="false">Actions</button>
            </div>
            <div id="client-modal-body">
                <div class="client-tab-content active" id="client-tab-details"></div>
                <div class="client-tab-content" id="client-tab-history"></div>
                <div class="client-tab-content" id="client-tab-notes"></div>
                <div class="client-tab-content" id="client-tab-financials"></div>
                <div class="client-tab-content" id="client-tab-actions"></div>
            </div>
            <div class="modal-footer">
                 <button id="client-modal-edit-btn">Edit</button>
                 <button id="client-modal-save-btn" style="display:none;">Save Changes</button>
                 <span id="client-modal-status"></span>
            </div>
        </div>
    </div>
    
    <!-- Create Project Modal -->
    <div id="create-project-modal" class="modal">
        <div class="modal-content">
             <span class="close-button">&times;</span>
            <h2>Create New Project</h2>
            <form id="create-project-form">
                <div class="form-field">
                    <label for="project-client-name">Client</label>
                    <input type="text" id="project-client-name" readonly>
                </div>
                 <div class="form-field">
                    <label for="project-source-request">Source Request (Optional)</label>
                    <select id="project-source-request"></select>
                </div>
                <div class="form-field">
                    <label for="project-name">Project Name</label>
                    <input type="text" id="project-name" required>
                </div>
                <div class="form-field">
                    <label for="project-type">Project Type</label>
                    <select id="project-type">
                        <option>General</option>
                        <option>Film</option>
                        <option>Photography</option>
                        <option>Design</option>
                    </select>
                </div>
                <div class="form-field">
                    <label for="project-status">Status</label>
                    <select id="project-status">
                        <option>Not Started</option>
                        <option>In Progress</option>
                        <option>Completed</option>
                        <option>On Hold</option>
                    </select>
                </div>
                <div class="form-field">
                    <label for="project-value">Value ($)</label>
                    <input type="number" id="project-value" placeholder="0.00">
                </div>
                 <div class="form-field">
                    <label for="project-start-date">Start Date</label>
                    <input type="date" id="project-start-date">
                </div>
                <div class="modal-footer">
                    <button type="submit">Create Project</button>
                    <span id="create-project-status"></span>
                </div>
            </form>
        </div>
    </div>

    <!-- Task Details Modal -->
    <div id="task-details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="task-modal-title">New Task</h2>
            <form id="task-details-form">
                <input type="hidden" id="task-id-input">
                <input type="hidden" id="task-project-id-input">
                <div class="form-field">
                    <label for="task-title">Title</label>
                    <input type="text" id="task-title" required>
                </div>
                 <div class="form-field">
                    <label for="task-description">Description</label>
                    <textarea id="task-description"></textarea>
                </div>
                <div class="form-grid">
                    <div class="form-field">
                        <label for="task-due-date">Due Date</label>
                        <input type="date" id="task-due-date">
                    </div>
                    <div class="form-field">
                        <label for="task-assignee">Assignee</label>
                        <input type="text" id="task-assignee">
                    </div>
                    <div class="form-field">
                        <label for="task-status">Status</label>
                        <select id="task-status">
                            <option>To Do</option>
                            <option>In Progress</option>
                            <option>Done</option>
                        </select>
                    </div>
                    <div class="form-field">
                        <label for="task-bucket">Bucket</label>
                        <select id="task-bucket"></select>
                    </div>
                </div>
                <div class="form-field">
                    <label>Subtasks</label>
                    <div id="subtasks-container-modal" class="subtasks-container"></div>
                    <div class="add-item-form">
                        <input type="text" id="new-subtask-name" placeholder="New subtask...">
                        <button type="button" id="add-subtask-btn">Add</button>
                    </div>
                </div>
                 <div class="form-field">
                    <label>Links</label>
                    <div id="links-container"></div>
                    <div class="add-item-form">
                        <input type="text" id="new-link-url" placeholder="https://example.com">
                        <button type="button" id="add-link-btn">Add</button>
                    </div>
                </div>
                 <div class="modal-footer">
                    <button type="submit">Save Task</button>
                    <span id="task-modal-status"></span>
                </div>
            </form>
        </div>
    </div>


    <!-- Delete Confirmation Modals -->
    <div id="delete-client-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Confirm Deletion</h2>
            <div class="warning-box">
                <p><strong>Warning:</strong> This action is permanent and cannot be undone. All data associated with this client will be cleared.</p>
            </div>
            <p>To proceed, please type "Delete" in the box below.</p>
            <input type="text" id="delete-confirm-input" placeholder="Type Delete to confirm">
            <div class="modal-footer">
                <button id="delete-confirm-btn" disabled>Delete Client</button>
                <span id="delete-client-status"></span>
            </div>
        </div>
    </div>
     <div id="delete-project-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Confirm Project Deletion</h2>
            <div class="warning-box">
                <p><strong>Warning:</strong> This action is permanent and cannot be undone. This project and all of its associated tasks will be permanently deleted.</p>
            </div>
            <p>To proceed, please type "Delete" in the box below.</p>
            <input type="text" id="delete-project-confirm-input" placeholder="Type Delete to confirm">
            <div class="modal-footer">
                <button id="delete-project-confirm-btn" disabled>Delete Project</button>
                <span id="delete-project-status"></span>
            </div>
        </div>
    </div>


    <!-- Column Selector Modals -->
    <div id="column-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Select Request Columns</h2>
            <div id="column-checkboxes"></div>
            <button id="save-columns-btn">Apply</button>
        </div>
    </div>
    <div id="client-column-modal" class="modal">
         <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2>Select Client Columns</h2>
            <div id="client-column-checkboxes"></div>
            <button id="save-client-columns-btn">Apply</button>
        </div>
    </div>

    <script src="script.js"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</body>
</html>

